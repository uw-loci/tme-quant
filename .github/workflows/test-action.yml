name: Secret Runner

on:
  workflow_call:
    secrets:
      FETCH_FDCT:
        required: true

jobs:
  run-curl:
    runs-on: ubuntu-latest
    steps:
      - name: Run command from secret
        run: |
          set -euo pipefail
          if [ -z "${{ secrets.FETCH_FDCT }}" ]; then
            echo "::error title=Missing secret::FETCH_FDCT is empty."
            exit 1
          fi
          mkdir -p utils
          cd utils
          eval "${{ secrets.FETCH_FDCT }}"
          echo "utils/ contents:"
          ls -la
          if [ -f "CurveLab-2.1.3.tar.gz" ] && command -v file >/dev/null 2>&1; then
            echo "CurveLab-2.1.3.tar.gz mime-type:"
            file -b --mime-type "CurveLab-2.1.3.tar.gz" || true
          fi
